{% extends "layout.html" %}
{% block title %}Paste #{{ paste.id }} {% endblock %}
{% block body %}
  <h2>Paste #{{ paste.id }}</h2>
  <dl>
    {% if paste.user %}
    <dt>Author
    <dd>{{ paste.user.name }}
    {% endif %}
    <dt>Date
    <dd>{{ paste.pub_date.strftime('%Y-%m-%d @ %H:%M') }}
    <dt>Actions
    <dd><a href="{{url_for('view_raw',paste_id=paste.id)}}">raw</a>/
    <dd><a href="{{url_for('delete_paste',paste_id=paste.id)}}">delete</a>
    </dl>
  <div class='code'><pre class="highlight">{{ paste.code }}</pre></div>

  {% if paste.comments.all() %}
    <h3 class = "comment-head"><b>Comments:</b></h3>
    {% for i in paste.comments.all() %}
    <div class = "comment"><ul>
    <li><span class="comment-author">{{i.user.name}} said: </span><span class="comment-date">{{ i.pub_date.strftime('%Y-%m-%d @ %H:%M') }}</span></li>
    <pre class = "comment-box">{{i.message}}</pre></div>
  <hr>

    {% endfor %}
  {% else %}
  <p>No comments! Be the first one to comment.</p>
  {% endif %}

  {% if session['user_email'] %}
  <h3><ul><li>Comment</li></ul></h3>
  <form action="" method=post>
    <div class='code'><textarea name=comment cols=40 rows=4></textarea></div>
    <p><input class = "new-paste" type=submit value="Comment">
  </form>
  {% else %}
  <p> In order to comment you need to be logged in! Do so by <a href="{{url_for('login')}}">clicking here</a></p>
  {% endif %}
{% endblock %}
